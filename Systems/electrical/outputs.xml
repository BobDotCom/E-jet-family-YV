<PropertyList>


    <!-- DC ESS BUS 1 OUTPUTS -->
    <!-- unswitched outputs -->
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <property>/systems/electrical/buses/dc[3]/volts</property>
        </input>
        <output>/systems/electrical/outputs/adf[0]</output>
        <output>/systems/electrical/outputs/clock</output>
        <output>/systems/electrical/outputs/dme[0]</output>
        <output>/systems/electrical/outputs/eicas</output>
        <output>/systems/electrical/outputs/iess[0]</output>
        <output>/systems/electrical/outputs/master-warn-caution[0]</output>
    </filter>
    <!-- loads -->
    <filter>
        <type>gain</type>
        <output>/systems/electrical/buses/dc[3]/load</output>
        <input>
            <condition>
                <property>/systems/electrical/buses/dc[3]/powered</property>
            </condition>
            <expression>
                <sum>
                    <div>
                        <sum>
                            <product>
                                <property>/systems/electrical/outputs/adf[0]</property>
                                <value>0.5</value>
                            </product>
                            <product>
                                <property>/systems/electrical/outputs/clock</property>
                                <value>0.1</value>
                            </product>
                            <product>
                                <property>/systems/electrical/outputs/dme[0]</property>
                                <value>0.5</value>
                            </product>
                            <product>
                                <property>/systems/electrical/outputs/eicas</property>
                                <value>2</value>
                            </product>
                            <product>
                                <property>/systems/electrical/outputs/iess[0]</property>
                                <value>2</value>
                            </product>
                            <product>
                                <property>/systems/electrical/outputs/master-warn-caution[0]</property>
                                <value>0.5</value>
                            </product>
                        </sum>
                        <property>/systems/electrical/buses/dc[3]/volts</property>
                    </div>
                    <property>/systems/electrical/buses/dc[3]/loads/inverter</property>
                    <property>/systems/electrical/buses/dc[3]/loads/dc[5]</property>
                </sum>
            </expression>
        </input>
    </filter>

    <!-- DC ESS BUS 2 OUTPUTS -->
    <!-- unswitched outputs -->
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <property>/systems/electrical/buses/dc[4]/volts</property>
        </input>
        <output>/systems/electrical/outputs/mcdu[1]</output>
        <output>/systems/electrical/outputs/mfd[0]</output>
        <output>/systems/electrical/outputs/iess[1]</output>
        <output>/systems/electrical/outputs/master-warn-caution[1]</output>
    </filter>
    <!-- loads -->
    <filter>
        <type>gain</type>
        <output>/systems/electrical/buses/dc[4]/load</output>
        <input>
            <condition>
                <property>/systems/electrical/buses/dc[4]/powered</property>
            </condition>
            <expression>
                <sum>
                    <div>
                        <sum>
                            <product>
                                <property>/systems/electrical/outputs/mcdu[1]</property>
                                <value>2</value>
                            </product>
                            <product>
                                <property>/systems/electrical/outputs/mfd[0]</property>
                                <value>2</value>
                            </product>
                            <product>
                                <property>/systems/electrical/outputs/iess[1]</property>
                                <value>2</value>
                            </product>
                            <product>
                                <property>/systems/electrical/outputs/master-warn-caution[1]</property>
                                <value>0.5</value>
                            </product>
                        </sum>
                        <property>/systems/electrical/buses/dc[4]/volts</property>
                    </div>
                    <property>/systems/electrical/buses/dc[4]/loads/dc[5]</property>
                </sum>
            </expression>
        </input>
    </filter>

    <!-- DC ESS BUS 3 OUTPUTS -->
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <greater-than>
                    <property>/systems/electrical/buses/dc[5]/volts</property>
                    <value>18</value>
                </greater-than>
                <property>/controls/lighting/dome</property>
            </condition>
            <property>/systems/electrical/buses/dc[5]/volts</property>
        </input>
        <output>/systems/electrical/outputs/dome-light</output>
    </filter>
            
    <!-- unswitched outputs -->
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <property>/systems/electrical/buses/dc[5]/volts</property>
        </input>
        <output>/systems/electrical/outputs/pushbutton-lights</output>
        <output>/systems/electrical/outputs/rudder-trim</output>
        <output>/systems/electrical/outputs/crossfeed-valve</output>
    </filter>
    <!-- loads -->
    <filter>
        <type>gain</type>
        <output>/systems/electrical/buses/dc[5]/load</output>
        <input>
            <condition>
                <property>/systems/electrical/buses/dc[5]/powered</property>
            </condition>
            <expression>
                <sum>
                    <div>
                        <sum>
                            <product>
                                <property>/systems/electrical/outputs/dome-light</property>
                                <value>2.5</value>
                            </product>
                            <product>
                                <property>/systems/electrical/outputs/pushbutton-lights</property>
                                <value>0.5</value>
                            </product>
                        </sum>
                        <property>/systems/electrical/buses/dc[5]/volts</property>
                    </div>
                    <property>/systems/electrical/buses/dc[5]/loads/dc[3]</property>
                    <property>/systems/electrical/buses/dc[5]/loads/dc[4]</property>
                    <property>/systems/electrical/buses/dc[5]/loads/rudder-trim</property>
                </sum>
            </expression>
        </input>
    </filter>

    <filter>
        <name>Rudder trim power draw</name>
        <type>derivative</type>
        <input>/controls/flight/rudder-trim</input>
        <filter-time>0.1</filter-time>
        <output>/controls/flight/rudder-trim-motor</output>
    </filter>

    <filter>
        <type>moving-average</type>
        <samples>60</samples>
        <input>
            <condition>
                <greater-than>
                    <property>/systems/electrical/outputs/rudder-trim</property>
                    <value>18</value>
                </greater-than>
                <expression>
                    <greater-than>
                        <abs>
                            <property>/controls/flight/rudder-trim-motor</property>
                        </abs>
                        <value>0.00001</value>
                    </greater-than>
                </expression>
            </condition>
            <expression>
                <product>
                    <abs>
                        <property>/controls/flight/rudder-trim-motor</property>
                    </abs>
                    <!-- convert samples to s^-1 -->
                    <value>120</value>

                    <!-- convert movement units per second to amps -->
                    <value>40</value>
                </product>
            </expression>
        </input>
        <input><value>0</value></input>
        <output>/systems/electrical/buses/dc[5]/loads/rudder-trim</output>
    </filter>

    <!-- DC BUS 1 OUTPUTS -->
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <greater-than>
                    <property>/systems/electrical/buses/dc[1]/volts</property>
                    <value>18</value>
                </greater-than>
            </condition>
            <property>/controls/lighting/main-panel</property>
        </input>
        <output>/systems/electrical/outputs/main-panel-light</output>
    </filter>
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <greater-than>
                    <property>/systems/electrical/buses/dc[1]/volts</property>
                    <value>18</value>
                </greater-than>
            </condition>
            <property>/controls/lighting/pedestal</property>
        </input>
        <output>/systems/electrical/outputs/pedestal-light</output>
    </filter>
    <!-- unswitched outputs -->
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <property>/systems/electrical/buses/dc[1]/volts</property>
        </input>
        <output>/systems/electrical/outputs/mfd[1]</output>
        <output>/systems/electrical/outputs/mcdu[0]</output>
        <output>/systems/electrical/outputs/pfd[0]</output>
        <output>/systems/electrical/outputs/airstairs</output>
    </filter>

    <!-- DC BUS 2 OUTPUTS -->
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <greater-than>
                    <property>/systems/electrical/buses/dc[2]/volts</property>
                    <value>18</value>
                </greater-than>
            </condition>
            <property>/controls/lighting/overhead-panel</property>
        </input>
        <output>/systems/electrical/outputs/overhead-panel-light</output>
    </filter>
    
    <!-- unswitched outputs -->
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <property>/systems/electrical/buses/dc[2]/volts</property>
        </input>
        <output>/systems/electrical/outputs/pfd[1]</output>
        <output>/systems/electrical/outputs/nosewheel-steering</output>
        <output>/systems/electrical/outputs/nav[1]</output>
        <output>/systems/electrical/outputs/dme[1]</output>
        <output>/systems/electrical/outputs/adf[1]</output>
    </filter>

    <!-- AC ESS BUS OUTPUTS -->
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <property>/systems/electrical/buses/ac[3]/volts</property>
        </input>
        <output>/systems/electrical/outputs/efis</output>
    </filter>

    <!-- AC BUS 1 OUTPUTS -->
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <property>/systems/electrical/buses/ac[1]/volts</property>
        </input>
        <output>/systems/electrical/outputs/exciter[2]</output>
    </filter>
    <filter>
        <!-- actually on the GND SVC bus, but we're not modelling that -->
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <property>/controls/lighting/landing-lights[0]</property>
            </condition>
            <property>/systems/electrical/buses/ac[1]/volts</property>
        </input>
        <output>/systems/electrical/outputs/landing-lights[0]</output>
    </filter>
    <filter>
        <!-- actually on the GND SVC bus, but we're not modelling that -->
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <property>/controls/lighting/taxi-lights[0]</property>
            </condition>
            <property>/systems/electrical/buses/ac[1]/volts</property>
        </input>
        <output>/systems/electrical/outputs/taxi-lights[0]</output>
    </filter>
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <property>/controls/lighting/landing-lights[1]</property>
            </condition>
            <property>/systems/electrical/buses/ac[1]/volts</property>
        </input>
        <output>/systems/electrical/outputs/landing-lights[1]</output>
    </filter>
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <property>/controls/lighting/taxi-lights[1]</property>
            </condition>
            <property>/systems/electrical/buses/ac[1]/volts</property>
        </input>
        <output>/systems/electrical/outputs/taxi-lights[1]</output>
    </filter>
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <property>/sim/model/lights/beacon/state</property>
            </condition>
            <property>/systems/electrical/buses/ac[1]/volts</property>
        </input>
        <output>/systems/electrical/outputs/beacon</output>
    </filter>
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <property>/controls/lighting/nav-lights-switch</property>
            </condition>
            <property>/systems/electrical/buses/ac[1]/volts</property>
        </input>
        <output>/systems/electrical/outputs/nav-lights</output>
    </filter>
    <!-- AC BUS 1 LOAD -->
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <property>/systems/electrical/buses/ac[1]/powered</property>
                <property>/systems/electrical/outputs/exciter[2]</property>
                <property>/fadec/ignition[0]</property>
            </condition>
            <expression>
                <product>
                    <property>/systems/electrical/outputs/exciter[2]</property>
                    <value>0.02</value>
                </product>
            </expression>
        </input>
        <output>/systems/electrical/buses/ac[1]/loads/exciter[2]</output>
    </filter>
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <property>/systems/electrical/buses/ac[1]/powered</property>
            </condition>
            <expression>
                <sum>
                    <property>/systems/electrical/buses/ac[1]/loads/exciter[2]</property>
                    <property>/systems/electrical/buses/ac[1]/loads/ac[0]</property>
                    <property>/systems/electrical/buses/ac[1]/loads/ac[3]</property>
                </sum>
            </expression>
        </input>
        <output>/systems/electrical/buses/ac[1]/load</output>
    </filter>

    <!-- AC BUS 2 OUTPUTS -->
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <property>/systems/electrical/buses/ac[2]/volts</property>
        </input>
        <output>/systems/electrical/outputs/exciter[3]</output>
    </filter>
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <property>/controls/lighting/landing-lights[2]</property>
            </condition>
            <property>/systems/electrical/buses/ac[2]/volts</property>
        </input>
        <output>/systems/electrical/outputs/landing-lights[2]</output>
    </filter>
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <property>/controls/lighting/taxi-lights[1]</property>
            </condition>
            <property>/systems/electrical/buses/ac[2]/volts</property>
        </input>
        <output>/systems/electrical/outputs/taxi-lights[2]</output>
    </filter>
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <property>/sim/model/lights/strobe/state</property>
            </condition>
            <property>/systems/electrical/buses/ac[1]/volts</property>
        </input>
        <output>/systems/electrical/outputs/strobe</output>
    </filter>
    <!-- AC BUS 2 LOAD -->
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <property>/systems/electrical/buses/ac[2]/powered</property>
                <property>/systems/electrical/outputs/exciter[3]</property>
                <property>/fadec/ignition[1]</property>
            </condition>
            <expression>
                <product>
                    <property>/systems/electrical/outputs/exciter[3]</property>
                    <value>0.02</value>
                </product>
            </expression>
        </input>
        <output>/systems/electrical/buses/ac[2]/loads/exciter[3]</output>
    </filter>
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <property>/systems/electrical/buses/ac[2]/powered</property>
            </condition>
            <expression>
                <sum>
                    <property>/systems/electrical/buses/ac[2]/loads/exciter[3]</property>
                    <property>/systems/electrical/buses/ac[2]/loads/ac[0]</property>
                    <property>/systems/electrical/buses/ac[2]/loads/ac[3]</property>
                </sum>
            </expression>
        </input>
        <output>/systems/electrical/buses/ac[2]/load</output>
    </filter>

    <!-- AC ESS OUTPUTS -->
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <property>/systems/electrical/buses/ac[3]/powered</property>
            </condition>
            <expression>
                <sum>
                    <property>/systems/electrical/buses/ac[3]/loads/ac[4]</property>
                </sum>
            </expression>
        </input>
        <output>/systems/electrical/buses/ac[3]/load</output>
    </filter>

    <!-- AC STBY BUS OUTPUTS -->
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <property>/systems/electrical/buses/ac[4]/volts</property>
        </input>
        <output>/systems/electrical/outputs/exciter[0]</output>
        <output>/systems/electrical/outputs/exciter[1]</output>
    </filter>
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <property>/systems/electrical/buses/ac[4]/powered</property>
                <property>/systems/electrical/outputs/exciter[0]</property>
                <property>/fadec/ignition[0]</property>
            </condition>
            <expression>
                <product>
                    <property>/systems/electrical/outputs/exciter[0]</property>
                    <value>0.02</value>
                </product>
            </expression>
        </input>
        <output>/systems/electrical/buses/ac[4]/loads/exciter[0]</output>
    </filter>
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <property>/systems/electrical/buses/ac[4]/powered</property>
                <property>/systems/electrical/outputs/exciter[1]</property>
                <property>/fadec/ignition[1]</property>
            </condition>
            <expression>
                <product>
                    <property>/systems/electrical/outputs/exciter[1]</property>
                    <value>0.02</value>
                </product>
            </expression>
        </input>
        <output>/systems/electrical/buses/ac[4]/loads/exciter[1]</output>
    </filter>
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <property>/systems/electrical/buses/ac[4]/powered</property>
            </condition>
            <expression>
                <sum>
                    <property>/systems/electrical/buses/ac[4]/loads/exciter[0]</property>
                    <property>/systems/electrical/buses/ac[4]/loads/exciter[1]</property>
                </sum>
            </expression>
        </input>
        <output>/systems/electrical/buses/ac[4]/load</output>
    </filter>


    <!-- landing-light-norm outputs -->
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <greater-than>
                    <property>/systems/electrical/outputs/landing-lights[0]</property>
                    <value>110</value>
                </greater-than>
            </condition>
            <value>1</value>
        </input>
        <output>/systems/electrical/outputs/landing-lights-norm[0]</output>
    </filter>
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <greater-than>
                    <property>/systems/electrical/outputs/landing-lights[1]</property>
                    <value>110</value>
                </greater-than>
            </condition>
            <value>1</value>
        </input>
        <output>/systems/electrical/outputs/landing-lights-norm[1]</output>
    </filter>
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <greater-than>
                    <property>/systems/electrical/outputs/landing-lights[2]</property>
                    <value>110</value>
                </greater-than>
            </condition>
            <value>1</value>
        </input>
        <output>/systems/electrical/outputs/landing-lights-norm[2]</output>
    </filter>
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <greater-than>
                    <property>/systems/electrical/outputs/taxi-lights[0]</property>
                    <value>110</value>
                </greater-than>
            </condition>
            <value>1</value>
        </input>
        <output>/systems/electrical/outputs/taxi-lights-norm[0]</output>
    </filter>
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <greater-than>
                    <property>/systems/electrical/outputs/taxi-lights[1]</property>
                    <value>110</value>
                </greater-than>
            </condition>
            <value>1</value>
        </input>
        <output>/systems/electrical/outputs/taxi-lights-norm[1]</output>
    </filter>
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <greater-than>
                    <property>/systems/electrical/outputs/taxi-lights[2]</property>
                    <value>110</value>
                </greater-than>
            </condition>
            <value>1</value>
        </input>
        <output>/systems/electrical/outputs/taxi-lights-norm[2]</output>
    </filter>

    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <greater-than>
                    <property>/systems/electrical/outputs/logo-lights</property>
                    <value>110</value>
                </greater-than>
            </condition>
            <value>1</value>
        </input>
        <output>/systems/electrical/outputs/logo-lights-norm</output>
    </filter>
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <greater-than>
                    <property>/systems/electrical/outputs/nav-lights</property>
                    <value>110</value>
                </greater-than>
            </condition>
            <value>1</value>
        </input>
        <output>/systems/electrical/outputs/nav-lights-norm</output>
    </filter>
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <greater-than>
                    <property>/systems/electrical/outputs/beacon</property>
                    <value>110</value>
                </greater-than>
            </condition>
            <value>1</value>
        </input>
        <output>/systems/electrical/outputs/beacon-norm</output>
    </filter>
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <greater-than>
                    <property>/systems/electrical/outputs/strobe</property>
                    <value>110</value>
                </greater-than>
            </condition>
            <value>1</value>
        </input>
        <output>/systems/electrical/outputs/strobe-norm</output>
    </filter>

</PropertyList>
