<PropertyList>
    <!-- LEFT ENGINE -->
    <filter>
        <name>Starter Left</name>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <equals>
                    <property>fadec/engine-switch[0]</property>
                    <value>2</value>
                </equals>
            </condition>
            <value>1</value>
        </input>
        <input>
            <value>0</value>
        </input>
        <output>controls/engines/engine[0]/starter-switch</output>
    </filter>

    <filter>
        <name>Spring-load engine switch Left</name>
        <type>gain</type>
        <debug type="bool">true</debug>
        <gain>1</gain>
        <enable>
            <condition>
                <and>
                    <equals>
                        <property>fadec/engine-switch[0]</property>
                        <value>2</value>
                    </equals>
                    <greater-than>
                        <property>engines/engine[0]/n1</property>
                        <value>21.8</value>
                    </greater-than>
                </and>
            </condition>
        </enable>
        <input>
            <value>1</value>
        </input>
        <output>fadec/engine-switch[0]</output>
    </filter>

    <filter>
        <name>Cutoff Left</name>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <!-- engine switch "OFF": always cutoff fuel -->
            <condition>
                <equals>
                    <property>fadec/engine-switch[0]</property>
                    <value>0</value>
                </equals>
            </condition>
            <value>1</value>
        </input>
        <input>
            <condition>
                <or>
                    <!-- OVRD: always ignite -->
                    <equals>
                        <property>fadec/ignition-switch[0]</property>
                        <value>2</value>
                    </equals>
                    <!-- AUTO: ignite when N2 >= 20% -->
                    <and>
                        <equals>
                            <property>fadec/ignition-switch[0]</property>
                            <value>1</value>
                        </equals>
                        <greater-than>
                            <property>/engines/engine[0]/n2</property>
                            <value>20</value>
                        </greater-than>
                    </and>
                </or>
            </condition>
            <value>0</value>
        </input>
        <input>
            <value>1</value>
        </input>
        <output>controls/engines/engine[0]/cutoff-switch</output>
    </filter>

    <filter>
        <name>Target Left</name>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <expression>
                <table>
                    <property>/controls/engines/engine[0]/throttle</property>
                    <!-- IDLE -->
                    <entry>
                        <ind>0</ind><dep>21.8</dep>
                    </entry>
                    <!-- MAX -->
                    <entry>
                        <ind>1</ind><dep>100.0</dep>
                    </entry>
                </table>
            </expression>
        </input>
        <output>/fadec/target[0]</output>
    </filter>

    <pi-simple-controller>
        <name>Throttle Left</name>
        <debug>false</debug>
        <input>/engines/engine[0]/n1</input>
        <reference>/fadec/target[0]</reference>
        <output>/fadec/throttle-cmd-raw[0]</output>
        <config>
            <Kp><property>/fadec/config/Kp</property></Kp>
            <Ki><property>/fadec/config/Ki</property></Ki>
            <u_min>0.0</u_min>
            <u_max>100.0</u_max>
        </config>
    </pi-simple-controller>

    <filter>
        <type>noise-spike</type>
        <max-rate-of-change><property>/fadec/config/max-rate-of-change</property></max-rate-of-change>
        <input>
            <expression>
                <product>
                    <property>/fadec/throttle-cmd-raw[0]</property>
                    <value>0.01</value>
                </product>
            </expression>
        </input>
        <output>/fadec/throttle-cmd[0]</output>
    </filter>

    <!-- RIGHT ENGINE -->
    <filter>
        <name>Starter Right</name>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <condition>
                <equals>
                    <property>fadec/engine-switch[1]</property>
                    <value>2</value>
                </equals>
            </condition>
            <value>1</value>
        </input>
        <input>
            <value>0</value>
        </input>
        <output>controls/engines/engine[1]/starter-switch</output>
    </filter>

    <filter>
        <name>Spring-load engine switch Right</name>
        <type>gain</type>
        <debug type="bool">true</debug>
        <gain>1</gain>
        <enable>
            <condition>
                <and>
                    <equals>
                        <property>fadec/engine-switch[1]</property>
                        <value>2</value>
                    </equals>
                    <greater-than>
                        <property>engines/engine[1]/n1</property>
                        <value>21.8</value>
                    </greater-than>
                </and>
            </condition>
        </enable>
        <input>
            <value>1</value>
        </input>
        <output>fadec/engine-switch[1]</output>
    </filter>

    <filter>
        <name>Cutoff Right</name>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <!-- engine switch "OFF": always cutoff fuel -->
            <condition>
                <equals>
                    <property>fadec/engine-switch[1]</property>
                    <value>0</value>
                </equals>
            </condition>
            <value>1</value>
        </input>
        <input>
            <condition>
                <or>
                    <!-- OVRD: always ignite -->
                    <equals>
                        <property>fadec/ignition-switch[1]</property>
                        <value>2</value>
                    </equals>
                    <!-- AUTO: ignite when N2 >= 20% -->
                    <and>
                        <equals>
                            <property>fadec/ignition-switch[1]</property>
                            <value>1</value>
                        </equals>
                        <greater-than>
                            <property>/engines/engine[1]/n2</property>
                            <value>20</value>
                        </greater-than>
                    </and>
                </or>
            </condition>
            <value>0</value>
        </input>
        <input>
            <value>1</value>
        </input>
        <output>controls/engines/engine[1]/cutoff-switch</output>
    </filter>

    <filter>
        <name>Target Right</name>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <expression>
                <table>
                    <property>/controls/engines/engine[1]/throttle</property>
                    <!-- IDLE -->
                    <entry>
                        <ind>0</ind><dep>21.8</dep>
                    </entry>
                    <!-- MAX -->
                    <entry>
                        <ind>1</ind><dep>100.0</dep>
                    </entry>
                </table>
            </expression>
        </input>
        <output>/fadec/target[1]</output>
    </filter>

    <pi-simple-controller>
        <name>Throttle Right</name>
        <debug>false</debug>
        <input>/engines/engine[1]/n1</input>
        <reference>/fadec/target[1]</reference>
        <output>/fadec/throttle-cmd-raw[1]</output>
        <config>
            <Kp><property>/fadec/config/Kp</property></Kp>
            <Ki><property>/fadec/config/Ki</property></Ki>
            <u_min>0.0</u_min>
            <u_max>100.0</u_max>
        </config>
    </pi-simple-controller>

    <filter>
        <type>noise-spike</type>
        <max-rate-of-change><property>/fadec/config/max-rate-of-change</property></max-rate-of-change>
        <input>
            <expression>
                <product>
                    <property>/fadec/throttle-cmd-raw[1]</property>
                    <value>0.01</value>
                </product>
            </expression>
        </input>
        <output>/fadec/throttle-cmd[1]</output>
    </filter>
</PropertyList>
