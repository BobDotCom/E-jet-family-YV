<?xml version="1.0" encoding="UTF-8" ?>

<!-- Embraer 190 AOM page 1894 -->

<PropertyList>

    <filter>
        <name>MAC Length</name>
        <type>gain</type>
        <gain>1</gain>
        <update-interval-secs type="double">0.5</update-interval-secs>
        <input>
            <expression>
                <product>
                    <property>/fdm/jsbsim/metrics/cbarw-ft</property>
                    <!-- factor 0.66 (MAC vs. wing root chord)
                                        x
                                 feet to inches (12)
                    -->
                    <value>7.92094</value>
                </product>
            </expression>
        </input>
        <output>/fms/weight-and-balance/mac-length-in</output>
    </filter>

    <filter>
        <name>LEMAC</name>
        <type>gain</type>
        <gain>1</gain>
        <update-interval-secs type="double">0.5</update-interval-secs>
        <input>
            <expression>
                <product>
                    <property>/fms/weight-and-balance/mac-length-in</property>
                    <value>-0.5</value>
                </product>
            </expression>
        </input>
        <output>/fms/weight-and-balance/lemac</output>
    </filter>

    <filter>
        <name>CG MAC Position Normalized</name>
        <type>gain</type>
        <gain>1</gain>
        <update-interval-secs type="double">0.5</update-interval-secs>
        <input>
            <expression>
                <div>
                    <difference>
                        <property>/fdm/jsbsim/inertia/cg-x-in</property>
                        <property>/fms/weight-and-balance/lemac</property>
                    </difference>
                    <property>/fms/weight-and-balance/mac-length-in</property>
                </div>
            </expression>
        </input>
        <output>/fms/weight-and-balance/mac-position-norm</output>
    </filter>

    <filter>
        <name>CG Percent MAC</name>
        <type>gain</type>
        <gain>1</gain>
        <update-interval-secs type="double">0.5</update-interval-secs>
        <input>
            <expression>
                <product>
                    <property>/fms/weight-and-balance/mac-position-norm</property>
                    <value>100</value>
                </product>
            </expression>
        </input>
        <output>/fms/weight-and-balance/mac-position-percent</output>
    </filter>

    <filter>
        <name>CG Limit Ref Weight</name>
        <type>gain</type>
        <update-interval-secs type="double">0.5</update-interval-secs>
        <gain>0.4535924</gain> <!-- convert lbs to kg -->
        <input>
            <expression>
                <!-- oew190 + ((gw - oew) / (mtow - oew)) * (mtow190 - oew190) -->
                <sum>
                    <value>61370</value>
                    <product>
                        <div>
                            <difference>
                                <property>/fms/fuel/gw-lbs</property>
                                <property>/fdm/jsbsim/inertia/empty-weight-lbs</property>
                            </difference>
                            <difference>
                                <property>/limits/mass-and-balance/maximum-takeoff-mass-lbs</property>
                                <property>/fdm/jsbsim/inertia/empty-weight-lbs</property>
                            </difference>
                        </div>
                        <difference>
                            <value>114199</value>
                            <value>61370</value>
                        </difference>
                    </product>
                </sum>
            </expression>
        </input>
        <output>/fms/weight-and-balance/limit-ref-weight-kg</output>
    </filter>

    <filter>
        <name>CG Percent Takeoff Limit Low</name>
        <type>gain</type>
        <gain>1</gain>
        <update-interval-secs type="double">0.5</update-interval-secs>
        <input>
            <expression>
                <table>
                    <property>/fms/weight-and-balance/limit-ref-weight-kg</property>
                    <entry> <ind>29500</ind><dep>18.4</dep> </entry>
                    <entry> <ind>31500</ind><dep> 6.0</dep> </entry>
                    <entry> <ind>48090</ind><dep> 6.0</dep> </entry>
                    <entry> <ind>52000</ind><dep>10.7</dep> </entry>
                </table>
            </expression>
        </input>
        <output>/fms/weight-and-balance/mac-percent-min-takeoff</output>
    </filter>
    <filter>
        <name>CG Percent Takeoff Limit High</name>
        <type>gain</type>
        <gain>1</gain>
        <update-interval-secs type="double">0.5</update-interval-secs>
        <input>
            <expression>
                <table>
                    <property>/fms/weight-and-balance/limit-ref-weight-kg</property>
                    <entry> <ind>29500</ind><dep>18.4</dep> </entry>
                    <entry> <ind>30100</ind><dep>22.0</dep> </entry>
                    <entry> <ind>40400</ind><dep>29.0</dep> </entry>
                    <entry> <ind>40700</ind><dep>29.0</dep> </entry>
                    <entry> <ind>51800</ind><dep>27.0</dep> </entry>
                </table>
            </expression>
        </input>
        <output>/fms/weight-and-balance/mac-percent-max-takeoff</output>
    </filter>
    <filter>
        <name>CG Percent Landing Limit Low</name>
        <type>gain</type>
        <gain>1</gain>
        <update-interval-secs type="double">0.5</update-interval-secs>
        <input>
            <expression>
                <table>
                    <property>/fms/weight-and-balance/limit-ref-weight-kg</property>
                    <entry> <ind>28000</ind><dep>17.0</dep> </entry>
                    <entry> <ind>31500</ind><dep> 6.0</dep> </entry>
                    <entry> <ind>48090</ind><dep> 6.0</dep> </entry>
                    <entry> <ind>52000</ind><dep>10.7</dep> </entry>
                </table>
            </expression>
        </input>
        <output>/fms/weight-and-balance/mac-percent-min-landing</output>
    </filter>
    <filter>
        <name>CG Percent Landing Limit High</name>
        <type>gain</type>
        <gain>1</gain>
        <update-interval-secs type="double">0.5</update-interval-secs>
        <input>
            <expression>
                <table>
                    <property>/fms/weight-and-balance/limit-ref-weight-kg</property>
                    <entry> <ind>28000</ind><dep>23.4</dep> </entry>
                    <entry> <ind>37000</ind><dep>29.0</dep> </entry>
                    <entry> <ind>40700</ind><dep>29.0</dep> </entry>
                    <entry> <ind>51800</ind><dep>27.0</dep> </entry>
                </table>
            </expression>
        </input>
        <output>/fms/weight-and-balance/mac-percent-max-landing</output>
    </filter>
    <filter>
        <name>CG Percent Clean Config Limit Low</name>
        <type>gain</type>
        <gain>1</gain>
        <update-interval-secs type="double">0.5</update-interval-secs>
        <input>
            <expression>
                <table>
                    <property>/fms/weight-and-balance/limit-ref-weight-kg</property>
                    <entry> <ind>28000</ind><dep>15.0</dep> </entry>
                    <entry> <ind>31500</ind><dep> 4.0</dep> </entry>
                    <entry> <ind>48090</ind><dep> 4.0</dep> </entry>
                    <entry> <ind>52000</ind><dep> 8.7</dep> </entry>
                </table>
            </expression>
        </input>
        <output>/fms/weight-and-balance/mac-percent-min-clean</output>
    </filter>
    <filter>
        <name>CG Percent Clean Config Limit High</name>
        <type>gain</type>
        <gain>1</gain>
        <update-interval-secs type="double">0.5</update-interval-secs>
        <input>
            <expression>
                <table>
                    <property>/fms/weight-and-balance/limit-ref-weight-kg</property>
                    <entry> <ind>28000</ind><dep>25.4</dep> </entry>
                    <entry> <ind>37000</ind><dep>31.0</dep> </entry>
                    <entry> <ind>40700</ind><dep>31.0</dep> </entry>
                    <entry> <ind>51800</ind><dep>29.0</dep> </entry>
                </table>
            </expression>
        </input>
        <output>/fms/weight-and-balance/mac-percent-max-clean</output>
    </filter>

    <filter>
        <name>Zero-fuel weight</name>
        <type>gain</type>
        <gain>1</gain>
        <update-interval-secs type="double">1.0</update-interval-secs>
        <input>
            <expression>
                <difference>
                    <property>/fdm/jsbsim/inertia/weight-lbs</property>
                    <property>/consumables/fuel/total-fuel-lbs</property>
                </difference>
            </expression>
        </input>
        <output>/fms/fuel/zfw-lbs</output>
    </filter>

    <filter>
        <name>Zero-fuel weight (kg)</name>
        <type>gain</type>
        <update-interval-secs type="double">1.0</update-interval-secs>
        <gain>0.4535924</gain>
        <input>
            <property>/fms/fuel/zfw-lbs</property>
        </input>
        <output>/fms/fuel/zfw-kg</output>
    </filter>

    <filter>
        <name>Gross weight</name>
        <type>gain</type>
        <update-interval-secs type="double">1.0</update-interval-secs>
        <gain>1</gain>
        <input>
            <property>/fdm/jsbsim/inertia/weight-lbs</property>
        </input>
        <output>/fms/fuel/gw-lbs</output>
    </filter>

    <filter>
        <name>Gross weight (kg)</name>
        <type>gain</type>
        <update-interval-secs type="double">1.0</update-interval-secs>
        <gain>0.4535924</gain>
        <input>
            <property>/fms/fuel/gw-lbs</property>
        </input>
        <output>/fms/fuel/gw-kg</output>
    </filter>

    <filter>
        <name>Landing weight (kg)</name>
        <type>gain</type>
        <enable>
            <condition>
                <equals>
                    <property>/fms/landing-conditions/weight-kg</property>
                    <value>0</value>
                </equals>
            </condition>
        </enable>
        <input>
            <property>/fms/fuel/gw-kg</property>
        </input>
        <output>/fms/landing-conditions/weight-kg</output>
    </filter>
    <filter>
        <name>Takeoff weight (kg)</name>
        <type>gain</type>
        <enable>
            <condition>
                <equals>
                    <property>/fms/takeoff-conditions/weight-kg</property>
                    <value>0</value>
                </equals>
            </condition>
        </enable>
        <input>
            <property>/fms/fuel/gw-kg</property>
        </input>
        <output>/fms/takeoff-conditions/weight-kg</output>
    </filter>

    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <expression>
                <floor>
                    <property>/consumables/fuel/total-fuel-kg</property>
                </floor>
            </expression>
        </input>
        <output>/fms/fuel/current</output>
    </filter>

    <filter>
        <type>gain</type>
        <gain>1</gain>
        <input>
            <expression>
                <difference>
                    <property>/fms/fuel/original</property>
                    <property>/consumables/fuel/total-fuel-kg</property>
                </difference>
            </expression>
        </input>
        <output>/fms/fuel/used</output>
    </filter>

    <filter>
        <type>gain</type>
        <gain>1</gain>
        <enable>
            <condition>
                <greater-than>
                    <property>/consumables/fuel/total-fuel-kg</property>
                    <property>/fms/fuel/original</property>
                </greater-than>
            </condition>
        </enable>
        <input>
            <property>/consumables/fuel/total-fuel-kg</property>
        </input>
        <output>/fms/fuel/original</output>
    </filter>

    <filter>
        <type>gain</type>
        <gain>1</gain>
        <name>Fuel Pointer 1</name>
        <input>
            <condition>
                <less-than>
                    <property>/consumables/fuel/tank[0]/level-kg</property>
                    <value>800</value>
                </less-than>
            </condition>
            <expression>
                <floor>
                    <table>
                        <property>/consumables/fuel/tank[0]/level-kg</property>
                        <entry><ind>0</ind><dep>0</dep></entry>
                        <entry><ind>400</ind><dep>-48</dep></entry>
                        <entry><ind>800</ind><dep>-96</dep></entry>
                    </table>
                </floor>
            </expression>
        </input>
        <input>
            <expression>
                <floor>
                    <sum>
                        <product>
                            <div>
                                <difference>
                                    <property>/consumables/fuel/tank[0]/level-kg</property>
                                    <value>800</value>
                                </difference>
                                <difference>
                                    <product>
                                        <property>/consumables/fuel/tank[0]/capacity-m3</property>
                                        <property>/consumables/fuel/tank[0]/density-kgpm3</property>
                                    </product>
                                    <value>800</value>
                                </difference>
                            </div>
                            <value>-104</value>
                        </product>
                        <value>-96</value>
                    </sum>
                </floor>
            </expression>
        </input>
        <output>/fms/fuel/gauge[0]/pointer</output>
    </filter>
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <name>Fuel Pointer 2</name>
        <input>
            <condition>
                <less-than>
                    <property>/consumables/fuel/tank[1]/level-kg</property>
                    <value>800</value>
                </less-than>
            </condition>
            <expression>
                <floor>
                    <table>
                        <property>/consumables/fuel/tank[1]/level-kg</property>
                        <entry><ind>0</ind><dep>0</dep></entry>
                        <entry><ind>400</ind><dep>-48</dep></entry>
                        <entry><ind>800</ind><dep>-96</dep></entry>
                    </table>
                </floor>
            </expression>
        </input>
        <input>
            <expression>
                <floor>
                    <sum>
                        <product>
                            <div>
                                <difference>
                                    <property>/consumables/fuel/tank[1]/level-kg</property>
                                    <value>800</value>
                                </difference>
                                <difference>
                                    <product>
                                        <property>/consumables/fuel/tank[1]/capacity-m3</property>
                                        <property>/consumables/fuel/tank[1]/density-kgpm3</property>
                                    </product>
                                    <value>800</value>
                                </difference>
                            </div>
                            <value>-104</value>
                        </product>
                        <value>-96</value>
                    </sum>
                </floor>
            </expression>
        </input>
        <output>/fms/fuel/gauge[1]/pointer</output>
    </filter>
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <name>Fuel Pointer 3</name>
        <input>
            <condition>
                <greater-than>
                    <property>/consumables/fuel/tank[2]/capacity-m3</property>
                    <value>0</value>
                </greater-than>
            </condition>
            <expression>
                <floor>
                    <product>
                        <div>
                            <property>/consumables/fuel/tank[2]/level-kg</property>
                            <product>
                                <property>/consumables/fuel/tank[2]/capacity-m3</property>
                                <property>/consumables/fuel/tank[2]/density-kgpm3</property>
                            </product>
                        </div>
                        <value>-200</value>
                    </product>
                </floor>
            </expression>
        </input>
        <input><value>0</value></input>
        <output>/fms/fuel/gauge[2]/pointer</output>
    </filter>
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <name>Fuel Indicated 1</name>
        <output>/fms/fuel/gauge[0]/indicated</output>
        <input>
            <expression>
                <floor>
                    <property>/consumables/fuel/tank[0]/level-kg</property>
                </floor>
            </expression>
        </input>
    </filter>
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <name>Fuel Indicated 2</name>
        <output>/fms/fuel/gauge[1]/indicated</output>
        <input>
            <expression>
                <floor>
                    <property>/consumables/fuel/tank[1]/level-kg</property>
                </floor>
            </expression>
        </input>
    </filter>
    <filter>
        <type>gain</type>
        <gain>1</gain>
        <name>Fuel Indicated 3</name>
        <output>/fms/fuel/gauge[2]/indicated</output>
        <input>
            <expression>
                <floor>
                    <property>/consumables/fuel/tank[2]/level-kg</property>
                </floor>
            </expression>
        </input>
    </filter>

</PropertyList>
